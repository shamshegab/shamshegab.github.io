<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
  
    <script
    src="https://code.jquery.com/jquery-3.5.1.slim.js"
    integrity="sha256-DrT5NfxfbHvMHux31Lkhxg42LY6of8TaYyK50jnxRnM="
    crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <title></title>
  </head>
  <body>
    <div class="container" style="margin-top: 5vh;">
      <div class="row">
        <input type="file" id="input" />
      </div>
      <div class="row">
        <div id="result">
        </div>
      </div>
  </div>





  <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
<script>
  console.log(("Shmas sa sad"));
  
      var dict = {};
  function calculate(){
    var sum =0;
    for (var key in dict) {
      if (dict.hasOwnProperty(key)) {       
        var s= key.replace(/\s+/g, "").trim();
        s=s.replace('+','');
       sum = sum + (dict[key]* parseInt($('#'+s).val()))
      
       
      }
    }
    $('#res').html('<h3>Total : '+sum+'</h3>')
    console.log(sum);
    
  }
  const input = document.getElementById('input')

input.addEventListener('change', () => {
  readXlsxFile(input.files[0]).then((rows) => {
    console.log(rows);
    

   for(var i = 2;i<rows.length;i++){
    dict[rows[i][2]+" - "+rows[i][3]] = rows[i][4]+ (dict[rows[i][2]+" - "+rows[i][3]] || 0);;

   }
   $('#result').html('<form>')
   for (var key in dict) {
    if (dict.hasOwnProperty(key)) {       
      var s= key.replace(/\s+/g, "").trim();
        s=s.replace('+','');    
        $('#result').append(
        '<div class=\"form-group row\">'+
    '<label for=\"exampleInputnumber\">'+key+'</label>'+
    '<input type=\"number\" class=\"form-control\" value=\"0\" id=\"'+s+'\" required></div>'
        )
    }
  }
  $('#result').append(

    '<div class=\"row\" ><div class=\"col-6\" id=\"res\"></div><div class=\"col-6\"><button style=\"width:100%\"type=\"submit\" class="btn btn-primary" onclick=\"calculate()\">Calculate</button></div></div></form>'
  )
  
   
  })
})
</script>
  </body>



</html>
